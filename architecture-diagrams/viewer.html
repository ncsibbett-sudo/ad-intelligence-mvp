<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ad Intelligence Platform - Architecture Diagrams</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 40px 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .diagram-section {
            margin-bottom: 60px;
            page-break-inside: avoid;
        }

        .diagram-section:last-child {
            margin-bottom: 0;
        }

        h2 {
            color: #667eea;
            font-size: 1.8em;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }

        .diagram-container {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .diagram-container img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .description {
            margin-top: 20px;
            padding: 20px;
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            border-radius: 4px;
            text-align: left;
            line-height: 1.6;
        }

        footer {
            background: #f8f9fa;
            padding: 30px;
            text-align: center;
            color: #666;
            border-top: 1px solid #dee2e6;
        }

        .print-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #667eea;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.1em;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
            transition: all 0.3s;
            z-index: 1000;
        }

        .print-button:hover {
            background: #764ba2;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(118, 75, 162, 0.5);
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }

            .container {
                box-shadow: none;
                border-radius: 0;
            }

            .print-button {
                display: none;
            }

            .diagram-section {
                page-break-after: always;
            }

            .diagram-section:last-child {
                page-break-after: auto;
            }
        }

        @media (max-width: 768px) {
            .content {
                padding: 20px;
            }

            h1 {
                font-size: 1.8em;
            }

            h2 {
                font-size: 1.4em;
            }

            .print-button {
                bottom: 15px;
                right: 15px;
                padding: 12px 24px;
                font-size: 1em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Ad Intelligence Platform</h1>
            <p class="subtitle">Architecture Documentation & System Diagrams</p>
        </header>

        <div class="content">
            <div class="diagram-section">
                <h2>1. System Architecture Overview</h2>
                <div class="diagram-container">
                    <img src="01-system-architecture.png" alt="System Architecture">
                </div>
                <div class="description">
                    <strong>Overview:</strong> Complete system architecture showing the client layer (Next.js frontend), application layer (Vercel Edge Functions with API routes), data layer (Supabase), and external services (Google Ads, Stripe, OpenAI). This diagram illustrates the full data flow from user interactions through API processing to database storage.
                </div>
            </div>

            <div class="diagram-section">
                <h2>2. Authentication & Authorization Flow</h2>
                <div class="diagram-container">
                    <img src="02-auth-flow.png" alt="Authentication Flow">
                </div>
                <div class="description">
                    <strong>Overview:</strong> Sequence diagram showing the authentication flow using Supabase Auth with JWT tokens. Demonstrates how users sign in, receive tokens, and how those tokens are validated on subsequent API requests. Includes Row-Level Security (RLS) policy enforcement at the database level.
                </div>
            </div>

            <div class="diagram-section">
                <h2>3. AI Analysis Request Flow</h2>
                <div class="diagram-container">
                    <img src="03-ai-analysis-flow.png" alt="AI Analysis Flow">
                </div>
                <div class="description">
                    <strong>Overview:</strong> Details the AI analysis workflow, showing how free users get mock analysis (no cost) while paid users receive real OpenAI GPT-3.5 powered insights. Includes limit checking for free users and the database operations for storing analysis results.
                </div>
            </div>

            <div class="diagram-section">
                <h2>4. Payment & Upgrade Flow</h2>
                <div class="diagram-container">
                    <img src="04-payment-flow.png" alt="Payment Flow">
                </div>
                <div class="description">
                    <strong>Overview:</strong> Stripe payment integration flow from checkout session creation to webhook-based payment confirmation. Shows how the system creates a Stripe customer, generates a checkout session, processes payment, and updates user status via webhooks.
                </div>
            </div>

            <div class="diagram-section">
                <h2>5. Google Ads Integration Flow</h2>
                <div class="diagram-container">
                    <img src="05-google-ads-integration.png" alt="Google Ads Integration">
                </div>
                <div class="description">
                    <strong>Overview:</strong> OAuth 2.0 integration with Google Ads API. Demonstrates the complete flow from user authorization through token exchange, campaign data retrieval, and storage of ad creatives in the database. Includes token refresh mechanism for long-term API access.
                </div>
            </div>

            <div class="diagram-section">
                <h2>6. Database Schema & Relationships</h2>
                <div class="diagram-container">
                    <img src="06-database-schema.png" alt="Database Schema">
                </div>
                <div class="description">
                    <strong>Overview:</strong> Entity-relationship diagram showing all database tables, their fields, data types, and relationships. Includes the users table extended from Supabase auth, creatives for storing ads, analysis for AI results, and payments for transaction tracking.
                </div>
            </div>

            <div class="diagram-section">
                <h2>7. Technology Stack</h2>
                <div class="diagram-container">
                    <img src="07-tech-stack.png" alt="Technology Stack">
                </div>
                <div class="description">
                    <strong>Overview:</strong> Comprehensive view of all technologies used in the platform: frontend (Next.js, React, TypeScript, Tailwind), backend (Node.js, API Routes, SDKs), infrastructure (Vercel, Supabase, GitHub), and external APIs (Stripe, Google Ads, OpenAI).
                </div>
            </div>

            <div class="diagram-section">
                <h2>8. Deployment Architecture</h2>
                <div class="diagram-container">
                    <img src="08-deployment-architecture.png" alt="Deployment Architecture">
                </div>
                <div class="description">
                    <strong>Overview:</strong> Deployment pipeline from local development through GitHub to Vercel's global edge network. Shows the build process, serverless functions, preview deployments for pull requests, and connections to production external services.
                </div>
            </div>

            <div class="diagram-section">
                <h2>9. Row-Level Security (RLS) Architecture</h2>
                <div class="diagram-container">
                    <img src="09-rls-architecture.png" alt="RLS Architecture">
                </div>
                <div class="description">
                    <strong>Overview:</strong> Database-level security implementation using PostgreSQL Row-Level Security policies. Shows how JWT tokens are verified, user IDs are extracted, and policies are enforced for SELECT, INSERT, UPDATE, and DELETE operations to ensure users can only access their own data.
                </div>
            </div>

            <div class="diagram-section">
                <h2>10. Environment Variables Configuration</h2>
                <div class="diagram-container">
                    <img src="10-environment-variables.png" alt="Environment Variables">
                </div>
                <div class="description">
                    <strong>Overview:</strong> Configuration management showing public vs. secret environment variables, their usage in client-side code vs. API routes, and the security boundaries. Critical for understanding which credentials are exposed to the browser and which remain server-side only.
                </div>
            </div>
        </div>

        <footer>
            <p><strong>Ad Intelligence Platform - Architecture Documentation</strong></p>
            <p>Generated from ../docs/architecture/ARCHITECTURE_DIAGRAM.md using Mermaid CLI</p>
            <p style="margin-top: 10px; font-size: 0.9em;">All diagrams are available as individual PNG files in the architecture-diagrams directory</p>
        </footer>
    </div>

    <button class="print-button" onclick="window.print()">Print/Save as PDF</button>

    <script>
        // Add smooth scrolling
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth' });
                }
            });
        });

        // Log print action
        window.onbeforeprint = () => {
            console.log('Printing architecture diagrams...');
        };

        window.onafterprint = () => {
            console.log('Print dialog closed');
        };
    </script>
</body>
</html>
